{"ast":null,"code":"import \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createTextVNode as _createTextVNode } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"col-sm-12\"\n};\nvar _hoisted_2 = {\n  \"class\": \"card\"\n};\nvar _hoisted_3 = {\n  \"class\": \"card-header pb-0\"\n};\nvar _hoisted_4 = /*#__PURE__*/_createElementVNode(\"span\", null, \"!La medicina cura al ser humano, la veterinaria cura a la humanidad¡\", -1 /* HOISTED */);\nvar _hoisted_5 = {\n  \"class\": \"card-body\"\n};\nvar _hoisted_6 = {\n  \"class\": \"table-responsive theme-scrollbar data-table\"\n};\nvar _hoisted_7 = {\n  \"class\": \"mb-3 row justify-content-end\"\n};\nvar _hoisted_8 = /*#__PURE__*/_createElementVNode(\"label\", {\n  \"for\": \"table-complete-search\",\n  \"class\": \"col-xs-3 col-sm-auto col-form-label\"\n}, \"Buscar:\", -1 /* HOISTED */);\nvar _hoisted_9 = {\n  \"class\": \"col-xs-3 col-sm-auto\"\n};\nvar _hoisted_10 = {\n  \"class\": \"table table-striped table-bordered\"\n};\nvar _hoisted_11 = /*#__PURE__*/_createElementVNode(\"thead\", null, [/*#__PURE__*/_createElementVNode(\"tr\", null, [/*#__PURE__*/_createElementVNode(\"th\", {\n  scope: \"col\"\n}, \"Nombre\"), /*#__PURE__*/_createElementVNode(\"th\", {\n  scope: \"col\"\n}, \"Correo\"), /*#__PURE__*/_createElementVNode(\"th\", {\n  scope: \"col\"\n}, \"Teléfono\"), /*#__PURE__*/_createElementVNode(\"th\", {\n  scope: \"col\"\n}, \"bussiness\"), /*#__PURE__*/_createElementVNode(\"th\", {\n  scope: \"col\"\n}, \"Acciones\")])], -1 /* HOISTED */);\nvar _hoisted_12 = {\n  scope: \"row\"\n};\nvar _hoisted_13 = [\"src\"];\nvar _hoisted_14 = {\n  \"class\": \"text-center\"\n};\nvar _hoisted_15 = [\"onClick\"];\nvar _hoisted_16 = /*#__PURE__*/_createElementVNode(\"i\", {\n  \"class\": \"fa fa-pencil fa-lg\"\n}, null, -1 /* HOISTED */);\nvar _hoisted_17 = [_hoisted_16];\nvar _hoisted_18 = [\"onClick\"];\nvar _hoisted_19 = /*#__PURE__*/_createElementVNode(\"i\", {\n  \"class\": \"icofont icofont-close-circled font-danger ps-2\"\n}, null, -1 /* HOISTED */);\nvar _hoisted_20 = [_hoisted_19];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"h4\", null, \"Mi personal \" + _toDisplayString($data.busiId), 1 /* TEXT */), _hoisted_4]), _createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"form\", null, [_createElementVNode(\"div\", _hoisted_7, [_hoisted_8, _createElementVNode(\"div\", _hoisted_9, [_withDirectives(_createElementVNode(\"input\", {\n    id: \"table-complete-search\",\n    type: \"text\",\n    \"class\": \"form-control\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n      return $data.filterQuery = $event;\n    }),\n    placeholder: \"Buscar...\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.filterQuery]])])])]), _createElementVNode(\"table\", _hoisted_10, [_hoisted_11, _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($options.filteredPersonal, function (personal) {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: personal.id\n    }, [_createElementVNode(\"td\", _hoisted_12, [_createElementVNode(\"img\", {\n      \"class\": \"img-40 me-2\",\n      src: $options.getFotoUrl(personal.profile_photo),\n      alt: \"\"\n    }, null, 8 /* PROPS */, _hoisted_13), _createTextVNode(\" \" + _toDisplayString(personal.name) + \" \" + _toDisplayString(personal.last_name), 1 /* TEXT */)]), _createElementVNode(\"td\", null, _toDisplayString(personal.email), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(personal.phone_number), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(personal.business_id), 1 /* TEXT */), _createElementVNode(\"td\", _hoisted_14, [_createElementVNode(\"span\", {\n      onClick: function onClick($event) {\n        return $options.editar(personal.id);\n      }\n    }, [].concat(_hoisted_17), 8 /* PROPS */, _hoisted_15), _createElementVNode(\"span\", {\n      onClick: function onClick($event) {\n        return $options.eliminar(personal.id);\n      }\n    }, [].concat(_hoisted_20), 8 /* PROPS */, _hoisted_18)])]);\n  }), 128 /* KEYED_FRAGMENT */))])])])])])]);\n}","map":{"version":3,"names":["_createElementVNode","scope","_hoisted_16","_hoisted_19","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_toDisplayString","$data","busiId","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","id","type","_cache","$event","filterQuery","placeholder","_hoisted_10","_hoisted_11","_Fragment","_renderList","$options","filteredPersonal","personal","key","_hoisted_12","src","getFotoUrl","profile_photo","alt","_hoisted_13","_createTextVNode","name","last_name","email","phone_number","business_id","_hoisted_14","onClick","editar","_hoisted_17","_hoisted_15","eliminar","_hoisted_20","_hoisted_18"],"sources":["C:\\YARELI\\New\\VUE\\DogToralia\\src\\pages\\admin\\personal\\listPersonal.vue"],"sourcesContent":["<template>\r\n  <div class=\"col-sm-12\">\r\n    <div class=\"card\">\r\n      <div class=\"card-header pb-0\">\r\n        <h4>Mi personal {{ busiId  }}</h4>\r\n        <span>!La medicina cura al ser humano, la veterinaria cura a la humanidad¡</span>\r\n      </div>\r\n      <div class=\"card-body\">\r\n        <div class=\"table-responsive theme-scrollbar data-table\">\r\n          <form>\r\n            <div class=\"mb-3 row justify-content-end\">\r\n              <label for=\"table-complete-search\" class=\"col-xs-3 col-sm-auto col-form-label\">Buscar:</label>\r\n              <div class=\"col-xs-3 col-sm-auto\">\r\n                <input id=\"table-complete-search\" type=\"text\" class=\"form-control\" v-model=\"filterQuery\" placeholder=\"Buscar...\" />\r\n              </div>\r\n            </div>\r\n          </form>\r\n          <table class=\"table table-striped table-bordered\">\r\n            <thead>\r\n              <tr>\r\n                <th scope=\"col\">Nombre</th>\r\n                <th scope=\"col\">Correo</th>\r\n                <th scope=\"col\">Teléfono</th>                \r\n                <th scope=\"col\">bussiness</th>                \r\n                <th scope=\"col\">Acciones</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <tr v-for=\"personal in filteredPersonal\" :key=\"personal.id\">\r\n                <td scope=\"row\">\r\n                  <img class=\"img-40 me-2\" :src=\"getFotoUrl(personal.profile_photo)\" alt=\"\" />\r\n                  {{ personal.name }} {{ personal.last_name }}\r\n                </td>\r\n                <td>{{ personal.email }}</td>\r\n                <td>{{ personal.phone_number }}</td>\r\n                <td>{{personal.business_id }}</td>\r\n                <td class=\"text-center\">\r\n                  <span @click=\"editar(personal.id)\"><i class=\"fa fa-pencil fa-lg\"></i></span>\r\n                  <span @click=\"eliminar(personal.id)\"><i class=\"icofont icofont-close-circled font-danger ps-2\"></i></span>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\nimport Swal from 'sweetalert2';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      personal: [],\r\n      filterQuery: \"\",\r\n      busiId: this.$route.params.id,\r\n    };\r\n  },\r\n  computed: {\r\n    filteredPersonal() {\r\n      return this.personal.filter(personal => {\r\n        return (\r\n          personal.name.toLowerCase().includes(this.filterQuery.toLowerCase()) ||\r\n          personal.last_name.toLowerCase().includes(this.filterQuery.toLowerCase()) ||\r\n          personal.email.toLowerCase().includes(this.filterQuery.toLowerCase()) ||\r\n          personal.phone_number.toLowerCase().includes(this.filterQuery.toLowerCase())\r\n        );\r\n      });\r\n    }\r\n  },\r\n  created() {\r\n    this.listarPersonal();\r\n  },\r\n  watch: {\r\n    '$route.params.id': function(newId) {\r\n      this.busiId = newId;\r\n    }\r\n  },\r\n  methods: {\r\n    getFotoUrl(profile_photo) {\r\n      const baseUrl = 'http://127.0.0.1:8000/storage/';\r\n      return `${baseUrl}${profile_photo}`;\r\n    },\r\n    editar(id) {\r\n      this.$router.push({ name: 'editPersonal', params: { id } });\r\n    },\r\n    async listarPersonal() {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        this.errorMessage = 'No se encontró ningún token, redireccionando para iniciar sesión';\r\n        this.$router.push('/auth/login');\r\n        return;\r\n      }\r\n      try {\r\n        const myHeaders = new Headers();\r\n        myHeaders.append(\"Content-Type\", \"application/json\");\r\n        myHeaders.append(\"Authorization\", `Bearer ${token}`);\r\n        \r\n        const requestOptions = {\r\n          method: \"GET\",\r\n          headers: myHeaders,\r\n          redirect: \"follow\"\r\n        };\r\n\r\n        // fetch(\"https://devs-devitm.com/api/business/all\", requestOptions)\r\n        fetch(\"http://127.0.0.1:8000/api/staff\", requestOptions)\r\n        .then((response) => response.json())\r\n        .then((result) => {\r\n          this.personal = result.stylists;\r\n        });                \r\n      } catch (err) {\r\n        console.log('Error al obtener los negocios:', err);\r\n        this.error = 'Error al obtener los detalles de los negocios';\r\n      }\r\n    },\r\n    eliminar(id){\r\n          Swal.fire({\r\n              title: '¿Está seguro de eliminar este miembro del personal?',\r\n              icon: 'warning',\r\n              showCancelButton: true,\r\n              confirmButtonColor: '#3085d6',\r\n              cancelButtonColor: '#d33',\r\n              confirmButtonText: 'Sí, eliminar',\r\n              cancelButtonText: 'Cancelar'\r\n            }).then((result) => {\r\n              if (result.isConfirmed) {\r\n\r\n          const token = localStorage.getItem('token');\r\n            if (!token) {\r\n              this.errorMessage = 'No se encontró ningún token, redireccionando para iniciar sesión';\r\n              this.$router.push('/auth/login');\r\n              return;\r\n            }\r\n\r\n            const myHeaders = new Headers();\r\n            myHeaders.append(\"Content-Type\", \"application/json\");\r\n            myHeaders.append(\"Authorization\", `Bearer ${token}`);\r\n\r\n            console.log('ID de la mascota:', id);\r\n\r\n            const requestOptions = {\r\n              method: \"DELETE\",\r\n              headers: myHeaders,\r\n              redirect: \"follow\"\r\n            };\r\n\r\n            // fetch(`https://devs-devitm.com/api/pets/${id}`, requestOptions)\r\n            fetch(`http://127.0.0.1:8000/api/staff/${id}`, requestOptions)\r\n              .then(response => response.json())\r\n              .then(result => {\r\n                console.log('Resultado de la eliminación:', result);\r\n                // Vuelve a listar las mascotas para reflejar los cambios\r\n                this.listarPersonal();\r\n              })\r\n              .catch(err => {\r\n                console.error('Error al eliminar la mascota:', err);\r\n                if (err.response && err.response.data && err.response.data.message) {\r\n                  this.error = err.response.data.message;\r\n                } else {\r\n                  this.error = 'Error al eliminar el usuario';\r\n                }\r\n                Swal.fire(\r\n                      'Error!',\r\n                      'Hubo un problema al eliminar el usuario.',\r\n                      'error'\r\n                    );\r\n              });\r\n          }\r\n            });\r\n\r\n\r\n       }\r\n  }\r\n};\r\n</script>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}