{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.error.to-string.js\";\nimport \"core-js/modules/es.date.to-string.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.to-string.js\";\nimport { createStore } from 'vuex';\nimport menu from \"./modules/menu\";\nimport layout from \"./modules/layout\";\nexport default createStore({\n  state: {\n    token: localStorage.getItem('token') || null,\n    userType: localStorage.getItem('userType') || null // 'pet_owner' o 'business_owner'\n  },\n  mutations: {\n    SET_AUTH: function SET_AUTH(state, _ref) {\n      var token = _ref.token,\n        userType = _ref.userType;\n      state.token = token;\n      state.userType = userType;\n    },\n    CLEAR_AUTH: function CLEAR_AUTH(state) {\n      state.token = null;\n      state.userType = null;\n    }\n  },\n  actions: {\n    login: function login(_ref2, _ref3) {\n      var commit = _ref2.commit;\n      var token = _ref3.token,\n        userType = _ref3.userType;\n      localStorage.setItem('token', token);\n      localStorage.setItem('userType', userType);\n      commit('SET_AUTH', {\n        token: token,\n        userType: userType\n      });\n    },\n    logout: function logout(_ref4) {\n      var state = _ref4.state,\n        commit = _ref4.commit;\n      return new Promise(function (resolve, reject) {\n        var myHeaders = new Headers();\n        var tokenBearer = \"Bearer \" + localStorage.getItem(\"token\");\n        myHeaders.append(\"Authorization\", tokenBearer.toString());\n        var url = '';\n        if (state.userType === 'pet_owner') {\n          url = \"https://devs-devitm.com/api/pet_owner/logout\";\n        } else if (state.userType === 'business_owner') {\n          url = \"https://devs-devitm.com/api/business_owner/logout\";\n        }\n        var requestOptions = {\n          method: 'POST',\n          headers: myHeaders,\n          redirect: 'follow'\n        };\n        fetch(url, requestOptions).then(function (response) {\n          return response.text();\n        }).then(function (result) {\n          var resultado = JSON.parse(result);\n          if (resultado.status === \"success\") {\n            localStorage.removeItem('token');\n            localStorage.removeItem('userType');\n            commit('CLEAR_AUTH');\n            resolve();\n          } else {\n            reject(new Error('Error al cerrar sesión'));\n          }\n        })[\"catch\"](function (error) {\n          return reject(error);\n        });\n      });\n    }\n  },\n  getters: {\n    isAuthenticated: function isAuthenticated(state) {\n      return !!state.token;\n    },\n    isPetOwner: function isPetOwner(state) {\n      return state.userType === 'pet_owner';\n    },\n    isBusinessOwner: function isBusinessOwner(state) {\n      return state.userType === 'business_owner';\n    }\n  },\n  modules: {\n    menu: menu,\n    layout: layout\n  }\n});","map":{"version":3,"names":["createStore","menu","layout","state","token","localStorage","getItem","userType","mutations","SET_AUTH","_ref","CLEAR_AUTH","actions","login","_ref2","_ref3","commit","setItem","logout","_ref4","Promise","resolve","reject","myHeaders","Headers","tokenBearer","append","toString","url","requestOptions","method","headers","redirect","fetch","then","response","text","result","resultado","JSON","parse","status","removeItem","Error","error","getters","isAuthenticated","isPetOwner","isBusinessOwner","modules"],"sources":["C:/YARELI/New/VUE/DogToralia/src/store/index.js"],"sourcesContent":["import { createStore } from 'vuex'\nimport menu from \"./modules/menu\"\nimport layout from \"./modules/layout\"\nexport default createStore({\n  state: {\n    token: localStorage.getItem('token') || null,\n    userType: localStorage.getItem('userType') || null, // 'pet_owner' o 'business_owner'\n  },\n  \n  mutations: {\n    SET_AUTH(state, { token, userType }) {\n      state.token = token;\n      state.userType = userType;\n     },\n    CLEAR_AUTH(state) {\n      state.token = null;\n      state.userType = null;\n      },\n  },\n  actions: {\n    login({ commit }, { token, userType }) {\n      localStorage.setItem('token', token);\n      localStorage.setItem('userType', userType);\n      commit('SET_AUTH', { token, userType });\n    },\n    logout({ state, commit }) {\n      return new Promise((resolve, reject) => {\n        var myHeaders = new Headers();\n        let tokenBearer = \"Bearer \" + localStorage.getItem(\"token\");\n        myHeaders.append(\"Authorization\", tokenBearer.toString());\n\n        let url = '';\n        if (state.userType === 'pet_owner') {\n          url = \"https://devs-devitm.com/api/pet_owner/logout\";\n        } else if (state.userType === 'business_owner') {\n          url = \"https://devs-devitm.com/api/business_owner/logout\";\n        }\n\n        var requestOptions = {\n          method: 'POST',\n          headers: myHeaders,\n          redirect: 'follow',\n        };\n\n        fetch(url, requestOptions)\n          .then(response => response.text())\n          .then(result => {\n            let resultado = JSON.parse(result);\n            if (resultado.status === \"success\") {\n              localStorage.removeItem('token');\n              localStorage.removeItem('userType');\n              commit('CLEAR_AUTH');\n              resolve();\n            } else {\n              reject(new Error('Error al cerrar sesión'));\n            }\n          })\n          .catch(error => reject(error));\n      });\n    },\n\n  },\n  getters: {\n    isAuthenticated: state => !!state.token,\n    isPetOwner: state => state.userType === 'pet_owner',\n    isBusinessOwner: state => state.userType === 'business_owner',\n  },\n  modules: {\n    menu,\n    layout\n  }\n})\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}