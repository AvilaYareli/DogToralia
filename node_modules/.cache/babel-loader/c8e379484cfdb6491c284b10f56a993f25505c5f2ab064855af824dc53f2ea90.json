{"ast":null,"code":"import _toConsumableArray from \"C:/YARELI/New/VUE/DogToralia/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _regeneratorRuntime from \"C:/YARELI/New/VUE/DogToralia/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/YARELI/New/VUE/DogToralia/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.error.to-string.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.some.js\";\nimport \"core-js/modules/es.array.splice.js\";\nimport \"core-js/modules/es.date.to-json.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport { Modal } from 'bootstrap';\nimport { useToast } from 'vue-toastification';\nexport default {\n  data: function data() {\n    return {\n      // Tu data sigue igual\n    };\n  },\n  setup: function setup() {\n    var toast = useToast();\n    return {\n      toast: toast\n    };\n  },\n  methods: {\n    addSlot: function addSlot(index) {\n      this.schedule[index].time_slots.push({\n        start_time: '',\n        end_time: ''\n      });\n    },\n    removeSlot: function removeSlot(dayIndex, slotIndex) {\n      this.schedule[dayIndex].time_slots.splice(slotIndex, 1);\n    },\n    showModal: function showModal() {\n      var modalElement = document.getElementById('scheduleModal');\n      var modal = new Modal(modalElement);\n      modal.show();\n    },\n    fixSlots: function fixSlots(dayIndex) {\n      var _this = this;\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var selectedDay, token, incompleteSlots, invalidTimes, response;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              selectedDay = _this.schedule[dayIndex];\n              if (!(selectedDay.day_of_week === 'Monday')) {\n                _context.next = 4;\n                break;\n              }\n              _this.showModal();\n              return _context.abrupt(\"return\");\n            case 4:\n              token = localStorage.getItem('token');\n              if (token) {\n                _context.next = 9;\n                break;\n              }\n              _this.toast.error('No se encontró ningún token, redireccionando para iniciar sesión');\n              _this.$router.push('/auth/login');\n              return _context.abrupt(\"return\");\n            case 9:\n              incompleteSlots = selectedDay.time_slots.some(function (slot) {\n                return !slot.start_time || !slot.end_time;\n              });\n              if (!incompleteSlots) {\n                _context.next = 13;\n                break;\n              }\n              _this.toast.error('Por favor completa todas las franjas horarias antes de fijarlas.');\n              return _context.abrupt(\"return\");\n            case 13:\n              invalidTimes = selectedDay.time_slots.some(function (slot) {\n                return slot.start_time >= slot.end_time;\n              });\n              if (!invalidTimes) {\n                _context.next = 17;\n                break;\n              }\n              _this.toast.error('La hora de inicio debe ser antes que la hora de fin.');\n              return _context.abrupt(\"return\");\n            case 17:\n              _context.prev = 17;\n              _context.next = 20;\n              return fetch(\"http://127.0.0.1:8000/api/business/schedule/\".concat(_this.busiId), {\n                method: 'POST',\n                headers: {\n                  'Content-Type': 'application/json',\n                  'Authorization': \"Bearer \".concat(token)\n                },\n                body: JSON.stringify({\n                  schedule: [{\n                    day_of_week: selectedDay.day_of_week,\n                    time_slots: selectedDay.time_slots\n                  }]\n                })\n              });\n            case 20:\n              response = _context.sent;\n              if (response.ok) {\n                _context.next = 23;\n                break;\n              }\n              throw new Error('Error al registrar las franjas horarias');\n            case 23:\n              _this.toast.success('Franjas horarias registradas correctamente.');\n              _context.next = 29;\n              break;\n            case 26:\n              _context.prev = 26;\n              _context.t0 = _context[\"catch\"](17);\n              _this.toast.error('Hubo un error al registrar las franjas horarias.');\n            case 29:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[17, 26]]);\n      }))();\n    },\n    applyScheduleToSelectedDays: function applyScheduleToSelectedDays() {\n      var _this2 = this;\n      var mondaySlots = this.schedule.find(function (day) {\n        return day.day_of_week === 'Monday';\n      }).time_slots;\n      this.selectedDays.forEach(function (day) {\n        var daySchedule = _this2.schedule.find(function (d) {\n          return d.day_of_week === day;\n        });\n        if (daySchedule) {\n          daySchedule.time_slots = _toConsumableArray(mondaySlots);\n        }\n      });\n      var modal = Modal.getInstance(document.getElementById('scheduleModal'));\n      modal.hide();\n      this.toast.success('Horarios aplicados correctamente a los días seleccionados.');\n    }\n  }\n};","map":{"version":3,"names":["Modal","useToast","data","setup","toast","methods","addSlot","index","schedule","time_slots","push","start_time","end_time","removeSlot","dayIndex","slotIndex","splice","showModal","modalElement","document","getElementById","modal","show","fixSlots","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","selectedDay","token","incompleteSlots","invalidTimes","response","wrap","_callee$","_context","prev","next","day_of_week","abrupt","localStorage","getItem","error","$router","some","slot","fetch","concat","busiId","method","headers","body","JSON","stringify","sent","ok","Error","success","t0","stop","applyScheduleToSelectedDays","_this2","mondaySlots","find","day","selectedDays","forEach","daySchedule","d","_toConsumableArray","getInstance","hide"],"sources":["C:\\YARELI\\New\\VUE\\DogToralia\\src\\pages\\admin\\horarios\\regisHorario.vue"],"sourcesContent":["<template>\r\n  <div class=\"card\">\r\n    <div class=\"container mt-5\">\r\n      <h1 class=\"text-center\">Registrar Horario para Negocio {{ busiId }}</h1>\r\n\r\n      <form>\r\n        <div v-for=\"(day, index) in schedule\" :key=\"index\" class=\"mb-4\">\r\n          <h4>{{ day.day_of_week }}</h4>\r\n\r\n          <div class=\"d-flex justify-content-end\">\r\n            <button class=\"btn btn-info mt-2\" @click.prevent=\"addSlot(index)\">Añadir Franja Horaria</button>\r\n          </div>\r\n\r\n          <div v-for=\"(slot, idx) in day.time_slots\" :key=\"idx\" class=\"row mb-2\">\r\n            <div class=\"col-sm-6 col-md-3\">\r\n              <label>Apertura</label>\r\n              <input type=\"time\" v-model=\"slot.start_time\" class=\"form-control\" required />\r\n            </div>\r\n            <div class=\"col-sm-6 col-md-3\">\r\n              <label>Cierre</label>\r\n              <input type=\"time\" v-model=\"slot.end_time\" class=\"form-control\" required />\r\n            </div>\r\n            <div class=\"col-2 d-flex align-items-end\">\r\n              <span @click=\"removeSlot(index, idx)\">\r\n                <i class=\"icofont icofont-close-circled font-danger fs-4\"></i>\r\n              </span>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Botón para fijar todas las franjas horarias del día -->\r\n          <div class=\"d-flex justify-content mt-2\">\r\n            <button @click.prevent=\"fixSlots(index)\" class=\"btn btn-primary\">Fijar Horarios</button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n  <!-- Modal -->\r\n  <div class=\"modal fade\" id=\"scheduleModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\r\n    <div class=\"modal-dialog\" role=\"document\">\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header\">\r\n          <h5 class=\"modal-title\">¿Deseas guardar el mismo horario para los demás días?</h5>\r\n          <button class=\"btn-close\" type=\"button\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n          <p>Seleccionaste el lunes. ¿Quieres aplicar el mismo horario para otros días?</p>\r\n          <!-- Selección de días -->\r\n          <div>\r\n            <label v-for=\"(day, index) in days\" :key=\"index\">\r\n              <input type=\"checkbox\" :value=\"day\" v-model=\"selectedDays\">\r\n              {{ day }}\r\n            </label>\r\n          </div>\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n          <button class=\"btn btn-primary\" @click.prevent=\"applyScheduleToSelectedDays\" type=\"button\">Sí</button>\r\n          <button class=\"btn btn-secondary\" type=\"button\" data-bs-dismiss=\"modal\">No</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { Modal } from 'bootstrap';\r\nimport { useToast } from 'vue-toastification';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      // Tu data sigue igual\r\n    };\r\n  },\r\n  setup() {\r\n    const toast = useToast();\r\n    return { toast };\r\n  },\r\n  methods: {\r\n    addSlot(index) {\r\n      this.schedule[index].time_slots.push({ start_time: '', end_time: '' });\r\n    },\r\n\r\n    removeSlot(dayIndex, slotIndex) {\r\n      this.schedule[dayIndex].time_slots.splice(slotIndex, 1);\r\n    },\r\n\r\n    showModal() {\r\n      const modalElement = document.getElementById('scheduleModal');\r\n      const modal = new Modal(modalElement);\r\n      modal.show();\r\n    },\r\n\r\n    async fixSlots(dayIndex) {\r\n      const selectedDay = this.schedule[dayIndex];\r\n\r\n      if (selectedDay.day_of_week === 'Monday') {\r\n        this.showModal();\r\n        return;\r\n      }\r\n\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        this.toast.error('No se encontró ningún token, redireccionando para iniciar sesión');\r\n        this.$router.push('/auth/login');\r\n        return;\r\n      }\r\n\r\n      const incompleteSlots = selectedDay.time_slots.some(slot => !slot.start_time || !slot.end_time);\r\n      if (incompleteSlots) {\r\n        this.toast.error('Por favor completa todas las franjas horarias antes de fijarlas.');\r\n        return;\r\n      }\r\n\r\n      const invalidTimes = selectedDay.time_slots.some(slot => slot.start_time >= slot.end_time);\r\n      if (invalidTimes) {\r\n        this.toast.error('La hora de inicio debe ser antes que la hora de fin.');\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const response = await fetch(`http://127.0.0.1:8000/api/business/schedule/${this.busiId}`, {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'Authorization': `Bearer ${token}`\r\n          },\r\n          body: JSON.stringify({\r\n            schedule: [\r\n              {\r\n                day_of_week: selectedDay.day_of_week,\r\n                time_slots: selectedDay.time_slots\r\n              }\r\n            ]\r\n          })\r\n        });\r\n\r\n        if (!response.ok) throw new Error('Error al registrar las franjas horarias');\r\n\r\n        this.toast.success('Franjas horarias registradas correctamente.');\r\n      } catch (error) {\r\n        this.toast.error('Hubo un error al registrar las franjas horarias.');\r\n      }\r\n    },\r\n\r\n    applyScheduleToSelectedDays() {\r\n      const mondaySlots = this.schedule.find(day => day.day_of_week === 'Monday').time_slots;\r\n\r\n      this.selectedDays.forEach(day => {\r\n        const daySchedule = this.schedule.find(d => d.day_of_week === day);\r\n        if (daySchedule) {\r\n          daySchedule.time_slots = [...mondaySlots];\r\n        }\r\n      });\r\n\r\n      const modal = Modal.getInstance(document.getElementById('scheduleModal'));\r\n      modal.hide();\r\n\r\n      this.toast.success('Horarios aplicados correctamente a los días seleccionados.');\r\n    }\r\n  }\r\n};\r\n</script>"],"mappings":";;;;;;;;;;;;;;AAgEA,SAASA,KAAI,QAAS,WAAW;AACjC,SAASC,QAAO,QAAS,oBAAoB;AAE7C,eAAe;EACbC,IAAI,WAAAA,KAAA,EAAG;IACL,OAAO;MACL;IAAA,CACD;EACH,CAAC;EACDC,KAAK,WAAAA,MAAA,EAAG;IACN,IAAMC,KAAI,GAAIH,QAAQ,CAAC,CAAC;IACxB,OAAO;MAAEG,KAAI,EAAJA;IAAM,CAAC;EAClB,CAAC;EACDC,OAAO,EAAE;IACPC,OAAO,WAAAA,QAACC,KAAK,EAAE;MACb,IAAI,CAACC,QAAQ,CAACD,KAAK,CAAC,CAACE,UAAU,CAACC,IAAI,CAAC;QAAEC,UAAU,EAAE,EAAE;QAAEC,QAAQ,EAAE;MAAG,CAAC,CAAC;IACxE,CAAC;IAEDC,UAAU,WAAAA,WAACC,QAAQ,EAAEC,SAAS,EAAE;MAC9B,IAAI,CAACP,QAAQ,CAACM,QAAQ,CAAC,CAACL,UAAU,CAACO,MAAM,CAACD,SAAS,EAAE,CAAC,CAAC;IACzD,CAAC;IAEDE,SAAS,WAAAA,UAAA,EAAG;MACV,IAAMC,YAAW,GAAIC,QAAQ,CAACC,cAAc,CAAC,eAAe,CAAC;MAC7D,IAAMC,KAAI,GAAI,IAAIrB,KAAK,CAACkB,YAAY,CAAC;MACrCG,KAAK,CAACC,IAAI,CAAC,CAAC;IACd,CAAC;IAEKC,QAAQ,WAAAA,SAACT,QAAQ,EAAE;MAAA,IAAAU,KAAA;MAAA,OAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,UAAAC,QAAA;QAAA,IAAAC,WAAA,EAAAC,KAAA,EAAAC,eAAA,EAAAC,YAAA,EAAAC,QAAA;QAAA,OAAAP,mBAAA,GAAAQ,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cACjBT,WAAU,GAAIL,KAAI,CAAChB,QAAQ,CAACM,QAAQ,CAAC;cAAA,MAEvCe,WAAW,CAACU,WAAU,KAAM,QAAQ;gBAAAH,QAAA,CAAAE,IAAA;gBAAA;cAAA;cACtCd,KAAI,CAACP,SAAS,CAAC,CAAC;cAAA,OAAAmB,QAAA,CAAAI,MAAA;YAAA;cAIZV,KAAI,GAAIW,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;cAAA,IACtCZ,KAAK;gBAAAM,QAAA,CAAAE,IAAA;gBAAA;cAAA;cACRd,KAAI,CAACpB,KAAK,CAACuC,KAAK,CAAC,kEAAkE,CAAC;cACpFnB,KAAI,CAACoB,OAAO,CAAClC,IAAI,CAAC,aAAa,CAAC;cAAA,OAAA0B,QAAA,CAAAI,MAAA;YAAA;cAI5BT,eAAc,GAAIF,WAAW,CAACpB,UAAU,CAACoC,IAAI,CAAC,UAAAC,IAAG;gBAAA,OAAK,CAACA,IAAI,CAACnC,UAAS,IAAK,CAACmC,IAAI,CAAClC,QAAQ;cAAA,EAAC;cAAA,KAC3FmB,eAAe;gBAAAK,QAAA,CAAAE,IAAA;gBAAA;cAAA;cACjBd,KAAI,CAACpB,KAAK,CAACuC,KAAK,CAAC,kEAAkE,CAAC;cAAA,OAAAP,QAAA,CAAAI,MAAA;YAAA;cAIhFR,YAAW,GAAIH,WAAW,CAACpB,UAAU,CAACoC,IAAI,CAAC,UAAAC,IAAG;gBAAA,OAAKA,IAAI,CAACnC,UAAS,IAAKmC,IAAI,CAAClC,QAAQ;cAAA,EAAC;cAAA,KACtFoB,YAAY;gBAAAI,QAAA,CAAAE,IAAA;gBAAA;cAAA;cACdd,KAAI,CAACpB,KAAK,CAACuC,KAAK,CAAC,sDAAsD,CAAC;cAAA,OAAAP,QAAA,CAAAI,MAAA;YAAA;cAAAJ,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAE,IAAA;cAAA,OAKjDS,KAAK,gDAAAC,MAAA,CAAgDxB,KAAI,CAACyB,MAAM,GAAI;gBACzFC,MAAM,EAAE,MAAM;gBACdC,OAAO,EAAE;kBACP,cAAc,EAAE,kBAAkB;kBAClC,eAAe,YAAAH,MAAA,CAAYlB,KAAK;gBAClC,CAAC;gBACDsB,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;kBACnB9C,QAAQ,EAAE,CACR;oBACE+B,WAAW,EAAEV,WAAW,CAACU,WAAW;oBACpC9B,UAAU,EAAEoB,WAAW,CAACpB;kBAC1B;gBAEJ,CAAC;cACH,CAAC,CAAC;YAAA;cAdIwB,QAAO,GAAAG,QAAA,CAAAmB,IAAA;cAAA,IAgBRtB,QAAQ,CAACuB,EAAE;gBAAApB,QAAA,CAAAE,IAAA;gBAAA;cAAA;cAAA,MAAQ,IAAImB,KAAK,CAAC,yCAAyC,CAAC;YAAA;cAE5EjC,KAAI,CAACpB,KAAK,CAACsD,OAAO,CAAC,6CAA6C,CAAC;cAAAtB,QAAA,CAAAE,IAAA;cAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAuB,EAAA,GAAAvB,QAAA;cAEjEZ,KAAI,CAACpB,KAAK,CAACuC,KAAK,CAAC,kDAAkD,CAAC;YAAA;YAAA;cAAA,OAAAP,QAAA,CAAAwB,IAAA;UAAA;QAAA,GAAAhC,OAAA;MAAA;IAExE,CAAC;IAEDiC,2BAA2B,WAAAA,4BAAA,EAAG;MAAA,IAAAC,MAAA;MAC5B,IAAMC,WAAU,GAAI,IAAI,CAACvD,QAAQ,CAACwD,IAAI,CAAC,UAAAC,GAAE;QAAA,OAAKA,GAAG,CAAC1B,WAAU,KAAM,QAAQ;MAAA,EAAC,CAAC9B,UAAU;MAEtF,IAAI,CAACyD,YAAY,CAACC,OAAO,CAAC,UAAAF,GAAE,EAAK;QAC/B,IAAMG,WAAU,GAAIN,MAAI,CAACtD,QAAQ,CAACwD,IAAI,CAAC,UAAAK,CAAA;UAAA,OAAKA,CAAC,CAAC9B,WAAU,KAAM0B,GAAG;QAAA,EAAC;QAClE,IAAIG,WAAW,EAAE;UACfA,WAAW,CAAC3D,UAAS,GAAA6D,kBAAA,CAAQP,WAAW,CAAC;QAC3C;MACF,CAAC,CAAC;MAEF,IAAM1C,KAAI,GAAIrB,KAAK,CAACuE,WAAW,CAACpD,QAAQ,CAACC,cAAc,CAAC,eAAe,CAAC,CAAC;MACzEC,KAAK,CAACmD,IAAI,CAAC,CAAC;MAEZ,IAAI,CAACpE,KAAK,CAACsD,OAAO,CAAC,4DAA4D,CAAC;IAClF;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}