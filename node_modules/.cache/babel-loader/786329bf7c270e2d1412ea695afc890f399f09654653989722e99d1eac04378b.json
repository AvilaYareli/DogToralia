{"ast":null,"code":"import _regeneratorRuntime from \"C:/YARELI/New/VUE/DogToralia/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/YARELI/New/VUE/DogToralia/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.error.to-string.js\";\nimport \"core-js/modules/es.date.to-json.js\";\nimport \"core-js/modules/es.date.to-string.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.to-string.js\";\nimport { createStore } from 'vuex';\nimport menu from \"./modules/menu\";\nimport layout from \"./modules/layout\";\nexport default createStore({\n  state: {\n    token: localStorage.getItem('token') || null,\n    userType: localStorage.getItem('userType') || null // 'pet_owner' o 'business_owner'\n  },\n  mutations: {\n    SET_AUTH: function SET_AUTH(state, _ref) {\n      var token = _ref.token,\n        userType = _ref.userType;\n      state.token = token;\n      state.userType = userType;\n    },\n    CLEAR_AUTH: function CLEAR_AUTH(state) {\n      state.token = null;\n      state.userType = null;\n    }\n  },\n  actions: {\n    // login({ commit }, { token, userType }) {\n    //   localStorage.setItem('token', token);\n    //   localStorage.setItem('userType', userType);\n    //   commit('SET_AUTH', { token, userType });\n    // },\n    login: function login(_ref2, _ref3) {\n      var commit = _ref2.commit;\n      var email = _ref3.email,\n        password = _ref3.password;\n      return new Promise( /*#__PURE__*/function () {\n        var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(resolve, reject) {\n          var myHeaders, raw, requestOptions, response, result, data;\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                myHeaders = new Headers();\n                myHeaders.append(\"Content-Type\", \"application/json\");\n                raw = JSON.stringify({\n                  email: email,\n                  password: password\n                });\n                requestOptions = {\n                  method: 'POST',\n                  headers: myHeaders,\n                  body: raw,\n                  redirect: 'follow'\n                };\n                _context.prev = 4;\n                _context.next = 7;\n                return fetch(\"https://devs-devitm.com/api/pet_owner/login\", requestOptions);\n              case 7:\n                response = _context.sent;\n                _context.next = 10;\n                return response.text();\n              case 10:\n                result = _context.sent;\n                data = JSON.parse(result);\n                if (!(data.status !== 'error')) {\n                  _context.next = 18;\n                  break;\n                }\n                // Inicio de sesión exitoso como petOwner\n                localStorage.setItem('token', data.authorization.token);\n                localStorage.setItem('userType', 'pet_owner');\n                commit('SET_AUTH', {\n                  token: data.authorization.token,\n                  userType: 'pet_owner'\n                });\n                resolve('pet_owner');\n                return _context.abrupt(\"return\");\n              case 18:\n                _context.next = 20;\n                return fetch(\"https://devs-devitm.com/api/business_owner/login\", requestOptions);\n              case 20:\n                response = _context.sent;\n                _context.next = 23;\n                return response.text();\n              case 23:\n                result = _context.sent;\n                data = JSON.parse(result);\n                if (!(data.status !== 'error')) {\n                  _context.next = 31;\n                  break;\n                }\n                // Inicio de sesión exitoso como businessOwner\n                localStorage.setItem('token', data.authorization.token);\n                localStorage.setItem('userType', 'business_owner');\n                commit('SET_AUTH', {\n                  token: data.authorization.token,\n                  userType: 'business_owner'\n                });\n                resolve('business_owner');\n                return _context.abrupt(\"return\");\n              case 31:\n                // Si ambas solicitudes fallan\n                reject(new Error(data.message || 'Correo o contraseña incorrectos.'));\n                _context.next = 37;\n                break;\n              case 34:\n                _context.prev = 34;\n                _context.t0 = _context[\"catch\"](4);\n                reject(new Error('Error al intentar iniciar sesión. Por favor, intenta nuevamente.'));\n              case 37:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee, null, [[4, 34]]);\n        }));\n        return function (_x, _x2) {\n          return _ref4.apply(this, arguments);\n        };\n      }());\n    },\n    logout: function logout(_ref5) {\n      var state = _ref5.state,\n        commit = _ref5.commit;\n      return new Promise(function (resolve, reject) {\n        var myHeaders = new Headers();\n        var tokenBearer = \"Bearer \" + localStorage.getItem(\"token\");\n        myHeaders.append(\"Authorization\", tokenBearer.toString());\n        var url = '';\n        if (state.userType === 'pet_owner') {\n          url = \"https://devs-devitm.com/api/pet_owner/logout\";\n        } else if (state.userType === 'business_owner') {\n          url = \"https://devs-devitm.com/api/business_owner/logout\";\n        }\n        var requestOptions = {\n          method: 'POST',\n          headers: myHeaders,\n          redirect: 'follow'\n        };\n        fetch(url, requestOptions).then(function (response) {\n          return response.text();\n        }).then(function (result) {\n          var resultado = JSON.parse(result);\n          if (resultado.status === \"success\") {\n            localStorage.removeItem('token');\n            localStorage.removeItem('userType');\n            commit('CLEAR_AUTH');\n            resolve();\n          } else {\n            reject(new Error('Error al cerrar sesión'));\n          }\n        })[\"catch\"](function (error) {\n          return reject(error);\n        });\n      });\n    }\n  },\n  getters: {\n    isAuthenticated: function isAuthenticated(state) {\n      return !!state.token;\n    },\n    isPetOwner: function isPetOwner(state) {\n      return state.userType === 'pet_owner';\n    },\n    isBusinessOwner: function isBusinessOwner(state) {\n      return state.userType === 'business_owner';\n    }\n  },\n  modules: {\n    menu: menu,\n    layout: layout\n  }\n});","map":{"version":3,"names":["createStore","menu","layout","state","token","localStorage","getItem","userType","mutations","SET_AUTH","_ref","CLEAR_AUTH","actions","login","_ref2","_ref3","commit","email","password","Promise","_ref4","_asyncToGenerator","_regeneratorRuntime","mark","_callee","resolve","reject","myHeaders","raw","requestOptions","response","result","data","wrap","_callee$","_context","prev","next","Headers","append","JSON","stringify","method","headers","body","redirect","fetch","sent","text","parse","status","setItem","authorization","abrupt","Error","message","t0","stop","_x","_x2","apply","arguments","logout","_ref5","tokenBearer","toString","url","then","resultado","removeItem","error","getters","isAuthenticated","isPetOwner","isBusinessOwner","modules"],"sources":["C:/YARELI/New/VUE/DogToralia/src/store/index.js"],"sourcesContent":["import { createStore } from 'vuex'\nimport menu from \"./modules/menu\"\nimport layout from \"./modules/layout\"\nexport default createStore({\n  state: {\n    token: localStorage.getItem('token') || null,\n    userType: localStorage.getItem('userType') || null, // 'pet_owner' o 'business_owner'\n  },\n  \n  mutations: {\n    SET_AUTH(state, { token, userType }) {\n      state.token = token;\n      state.userType = userType;\n     },\n    CLEAR_AUTH(state) {\n      state.token = null;\n      state.userType = null;\n      },\n  },\n  actions: {\n    // login({ commit }, { token, userType }) {\n    //   localStorage.setItem('token', token);\n    //   localStorage.setItem('userType', userType);\n    //   commit('SET_AUTH', { token, userType });\n    // },\n\n    login({ commit }, { email, password }) {\n      return new Promise(async (resolve, reject) => {\n        const myHeaders = new Headers();\n        myHeaders.append(\"Content-Type\", \"application/json\");\n\n        const raw = JSON.stringify({ email, password });\n\n        const requestOptions = {\n          method: 'POST',\n          headers: myHeaders,\n          body: raw,\n          redirect: 'follow',\n        };\n\n        try {\n          // Intentar iniciar sesión como petOwner\n          let response = await fetch(\"https://devs-devitm.com/api/pet_owner/login\", requestOptions);\n          let result = await response.text();\n          let data = JSON.parse(result);\n\n          if (data.status !== 'error') {\n            // Inicio de sesión exitoso como petOwner\n            localStorage.setItem('token', data.authorization.token);\n            localStorage.setItem('userType', 'pet_owner');\n            commit('SET_AUTH', { token: data.authorization.token, userType: 'pet_owner' });\n            resolve('pet_owner');\n            return;\n          }\n\n          // Intentar iniciar sesión como businessOwner\n          response = await fetch(\"https://devs-devitm.com/api/business_owner/login\", requestOptions);\n          result = await response.text();\n          data = JSON.parse(result);\n\n          if (data.status !== 'error') {\n            // Inicio de sesión exitoso como businessOwner\n            localStorage.setItem('token', data.authorization.token);\n            localStorage.setItem('userType', 'business_owner');\n            commit('SET_AUTH', { token: data.authorization.token, userType: 'business_owner' });\n            resolve('business_owner');\n            return;\n          }\n\n          // Si ambas solicitudes fallan\n          reject(new Error(data.message || 'Correo o contraseña incorrectos.'));\n        } catch (error) {\n          reject(new Error('Error al intentar iniciar sesión. Por favor, intenta nuevamente.'));\n        }\n      });\n    },\n    logout({ state, commit }) {\n      return new Promise((resolve, reject) => {\n        var myHeaders = new Headers();\n        let tokenBearer = \"Bearer \" + localStorage.getItem(\"token\");\n        myHeaders.append(\"Authorization\", tokenBearer.toString());\n\n        let url = '';\n        if (state.userType === 'pet_owner') {\n          url = \"https://devs-devitm.com/api/pet_owner/logout\";\n        } else if (state.userType === 'business_owner') {\n          url = \"https://devs-devitm.com/api/business_owner/logout\";\n        }\n\n        var requestOptions = {\n          method: 'POST',\n          headers: myHeaders,\n          redirect: 'follow',\n        };\n\n        fetch(url, requestOptions)\n          .then(response => response.text())\n          .then(result => {\n            let resultado = JSON.parse(result);\n            if (resultado.status === \"success\") {\n              localStorage.removeItem('token');\n              localStorage.removeItem('userType');\n              commit('CLEAR_AUTH');\n              resolve();\n            } else {\n              reject(new Error('Error al cerrar sesión'));\n            }\n          })\n          .catch(error => reject(error));\n      });\n    },\n\n  },\n  getters: {\n    isAuthenticated: state => !!state.token,\n    isPetOwner: state => state.userType === 'pet_owner',\n    isBusinessOwner: state => state.userType === 'business_owner',\n  },\n  modules: {\n    menu,\n    layout\n  }\n})\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}